# -*- coding: utf-8 -*-

import os

from logic.db import MaterialDatabase, NuclideDatabase


def rebuild(db_path):
    try:
        os.remove(os.path.abspath(db_path))
    except WindowsError:
        pass
    
    #===========================================================================
    # Materials
    #===========================================================================
    
    mdb = MaterialDatabase(db_path)
    
    # Lead
    e = [0.15, 0.3, 0.4, 0.5, 1.0, 2.0, 3.0, 4.0, 5.1, 6.0, 8.0, 10.0]
    mu_d = [1, 2, 4, 7, 10, 15, 20]
    b = [
         [1.01, 1.03, 1.06, 1.15, 1.16, 1.18, 1.19],
         [1.11, 1.17, 1.25, 1.34, 1.41, 1.50, 1.56],
         [1.17, 1.29, 1.46, 1.58, 1.72, 1.89, 2.02],
         [1.24, 1.42, 1.69, 2.00, 2.27, 2.65, 2.73],
         [1.37, 1.69, 2.26, 3.02, 3.74, 4.81, 5.86],
         [1.39, 1.76, 2.51, 3.66, 4.84, 6.87, 9.00],
         [1.34, 1.68, 2.43, 3.75, 5.30, 8.44, 12.3],
         [1.27, 1.56, 2.25, 3.61, 5.44, 9.80, 16.3],
         [1.21, 1.46, 2.08, 3.44, 5.55, 11.7, 23.6],
         [1.18, 1.40, 1.97, 3.34, 5.69, 13.8, 32.7],
         [1.14, 1.30, 1.74, 2.89, 5.07, 14.1, 44.6],
         [1.11, 1.23, 1.58, 2.52, 4.34, 12.5, 39.2]
         ]
    mass_atten_coeff_x = [0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.60, 0.80, 1.0, 1.5, 
                          2.0, 3.00, 4.0, 5.0, 6.0, 8.0, 10.0]
    mass_atten_coeff_y = [5.3200, 1.9000, 0.9330, 0.3690, 0.2150, 0.1500, 
                          0.1170, 0.0840, 0.0680, 0.0508, 0.0451, 0.0416, 
                          0.0416, 0.0424, 0.0433, 0.0456, 0.0488]
    density = 11.3
    mdb.add('Lead', 'Свинец', 'Pb', e, mu_d, b, density, mass_atten_coeff_x, 
            mass_atten_coeff_y)
    
    #===========================================================================
    # Nuclides
    #===========================================================================
    
    ndb = NuclideDatabase(db_path)
    spectre = [
               [0.511, 1.8],
               [1.275, 1.0],
               ]
    ndb.add('Na', 'Sodium', 'Натрий', '22', '11', spectre)
    spectre = [
               [1.369, 1.0],
               [2.754, 1.0],
               ]
    ndb.add('Na', 'Sodium', 'Натрий', '24', '11', spectre)
    
    #iridium-192
    spectre = [
               [1.060, 0.0040],
               [0.613, 0.0634],
               [0.604, 0.1090],
               [0.588, 0.0565],
               [0.485, 0.0293],
               [0.468, 0.4750],
               [0.417, 0.0127],               
               [0.375, 0.0146],
               [0.316, 0.8330],
               [0.308, 0.2720],
               [0.296, 0.2610],
               [0.283, 0.0049],
               [0.206, 0.0273],
               [0.201, 0.0034],
               ]
    
    ndb.add('Ir', 'Iridium', 'Иридий', '192', '77', spectre)
    
if __name__ == '__main__':
    db_path = os.path.abspath(os.path.join(os.curdir, '../../radiance.db'))
    rebuild(db_path)